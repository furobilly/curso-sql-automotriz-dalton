<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Dalton - M√≥dulo 1</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/sql-wasm.js"></script>
    <style>
        :root { --azul: #004a99; --gris: #f4f7f6; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--gris); }
        header { background: var(--azul); color: white; padding: 2rem; text-align: center; }
        .container { max-width: 900px; margin: 20px auto; padding: 20px; }
        section { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h2 { color: var(--azul); margin-top: 0; }
        .badge { background: #ffcc00; color: black; padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; font-weight: bold; }
        
        /* Consola Interactiva */
        .console { background: #2d2d2d; padding: 20px; border-radius: 8px; margin-top: 15px; }
        textarea { width: 100%; background: transparent; color: #a6e22e; border: none; font-family: monospace; font-size: 1.1rem; outline: none; }
        .btn-run { background: #28a745; color: white; border: none; padding: 12px 25px; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; }
        
        #result-table { margin-top: 20px; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #eee; padding: 10px; border: 1px solid #ddd; }
        td { padding: 8px; border: 1px solid #ddd; }
    </style>
</head>
<body>

<header>
    <h1>SQL Dalton: M√≥dulo 1</h1>
    <p>Filtrado Estrat√©gico de Datos <span id="status" style="font-size: 0.8rem; opacity: 0.8;">(Cargando...)</span></p>
</header>

<div class="container">
    <section>
        <h2>üìç Retos del M√≥dulo 1 <span class="badge">Nivel B√°sico</span></h2>
        <p>Usa la consola de abajo para resolver los retos de tu archivo <code>05_modulo_1_ejercicios.sql</code>:</p>
        <ol>
            <li><strong>Reto 1:</strong> Listar solo modelos de la marca 'Toyota'.</li>
            <li><strong>Reto 2:</strong> Autos con precio mayor a 500,000.</li>
        </ol>

        <div class="console">
            <textarea id="sql-code" rows="4">SELECT * FROM Catalogo_Modelos WHERE Marca = 'Toyota';</textarea>
        </div>
        <button class="btn-run" onclick="runSQL()">‚ñ∂ EJECUTAR RETO</button>

        <div id="result-table"></div>
    </section>

    <section>
        <h2>üìÇ Mis Archivos</h2>
        <p>Puedes consultar tus scripts aqu√≠:</p>
        <a href="database/05_modulo_1_ejercicios.sql" target="_blank">üìÑ Ver archivo de Ejercicios M√≥dulo 1</a>
    </section>
</div>

<script>
    let db;
    const config = { locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/${file}` };

    initSqlJs(config).then(async function(SQL){
        db = new SQL.Database();
        document.getElementById('status').innerText = "‚úÖ Motor Listo";

        // Cargamos tus tablas autom√°ticamente
        const files = ['database/01_creacion_tablas_dalton.sql', 'database/02_insertar_datos_dalton.sql'];
        for (let f of files) {
            const res = await fetch(f);
            const sql = await res.text();
            db.run(sql);
        }
    });

    function runSQL() {
        const code = document.getElementById('sql-code').value;
        const out = document.getElementById('result-table');
        try {
            const res = db.exec(code);
            if (res.length === 0) { out.innerHTML = "Consulta ejecutada."; return; }
            let html = "<table><thead><tr>";
            res[0].columns.forEach(c => html += `<th>${c}</th>`);
            html += "</tr></thead><tbody>";
            res[0].values.forEach(row => {
                html += "<tr>";
                row.forEach(v => html += `<td>${v}</td>`);
                html += "</tr>";
            });
            out.innerHTML = html + "</tbody></table>";
        } catch (e) { out.innerHTML = `<p style="color:red">Error: ${e.message}</p>`; }
    }
</script>
</body>
</html>
